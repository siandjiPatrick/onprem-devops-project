#cloud-config
#------------------  This code was generated by Terraform
#------------------   Please doâ€™nt edit it manually
#
##           @author: Patrick Siandji
##              Date: 15/07/2025
#


hostname: ${hostname}
manage_etc_hosts: true
fqdn: ${hostname}.local
disable_root: false
ssh_pwauth: ${ssh_pwauth}

users:
%{ for user in users ~}
  - name: ${user.name}
    groups: ${user.groups}
    shell: ${user.shell}
    lock_passwd: ${user.lock_passwd}
    sudo: ${user.sudo}
%{ if user.passwd != "" }
    passwd: ${user.passwd}
%{ endif }
%{ if length(user.ssh_authorized_keys) > 0 }
    ssh_pwauth: ${ssh_pwauth}
    ssh_authorized_keys:
%{ for key in user.ssh_authorized_keys ~}
      - ${key}
%{ endfor }
%{ endif }
%{ endfor }

package_update: true
package_upgrade: true

packages:
%{ for pkg in packages_to_install ~}
  - ${pkg}
%{ endfor }

runcmd:
%{ for cmd in run_command ~}
  - ${cmd}
%{ endfor }
